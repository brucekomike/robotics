# 第三章 控制系统的数学模型

**数学模型**: 描述系统的输入、输出变量以及系统内部各变量 (物理量) 之间关系的数学表达式。

## 时域数学模型:
*   微分方程 (连续系统)
*   差分方程 (离散系统)
*   状态方程

## 复域数学模型:
*   传递函数 (连续系统) — 拉普拉斯变换
*   脉冲传递函数 (离散系统)

## 频域数学模型:
*   频率特性

---

## 3.1 系统的微分方程

系统的微分方程是时域中描述系统动态特性的数学模型。

**线性系统**: 系统的数学模型能用线性微分方程来描述。反之，为非线性系统。

$$
a_n\frac{d^nx_o(t)}{dt^n} + a_{n-1}\frac{d^{n-1}x_o(t)}{dt^{n-1}} + \dots + a_1\frac{dx_o(t)}{dt} + a_0x_o(t) = b_m\frac{d^mx_i(t)}{dt^m} + b_{m-1}\frac{d^{m-1}x_i(t)}{dt^{m-1}} + \dots + b_1\frac{dx_i(t)}{dt} + b_0x_i(t)
$$

若 $a_i, b_j$ 都不是 $x_o(t)$, $x_i(t)$ 及它们导数的函数，为线性系统，同时与时间无关，则为线性定常系统。

**示例**:
*   $ \frac{d^2x_o(t)}{dt^2} + 2\frac{dx_o(t)}{dt} + 4x_o(t) = x_i(t) $ (线性定常)
*   $ \frac{d^2x_o(t)}{dt^2} + 2\frac{dx_o(t)}{dt} + 4tx_o(t) = x_i(t) $ (线性时变)
*   $ \frac{d^2x_o(t)}{dt^2} + x_o(t)\frac{dx_o(t)}{dt} + x_o^2(t) = tx_i(t) $ (非线性时变)

**线性系统满足叠加原理**。

### 典型元件所遵循的物理定律

**机械系统**:
*   **质量元件**: $F = M\frac{dv_{21}}{dt}$
*   **弹性元件**: $v_{21} = \frac{1}{k}\frac{dF}{dt}$
*   **阻尼元件**: $F = c v_{21}$

**示例**:
*   组合机床动力滑台铣平面时的情况:
    
    $$
    f_i(t) - c\frac{dy_o(t)}{dt} - ky_o(t) = m\frac{d^2y_o(t)}{dt^2}
    $$

    整理为:
    
    $$
    m\frac{d^2y_o(t)}{dt^2} + c\frac{dy_o(t)}{dt} + ky_o(t) = f_i(t)
    $$

*   机械系统 (示例):
    1.  明确系统的输入与输出: 输入为 $f(t)$，输出为 $x(t)$。
    2.  列写原始微分方程: $f - kx - cx = m\ddot{x}$
    3.  整理: $m\ddot{x} + c\dot{x} + kx = f$
*   汽车悬浮系统的原理图:
    
    $$
    m\frac{d^2x_o(t)}{dt^2} + c\frac{dx_o(t)}{dt} + kx_o(t) = c\frac{dx_i(t)}{dt} + kx_i(t)
    $$

**电气系统**:
*   **容性元件**: $i = C\frac{dv_{21}}{dt}$
*   **感性元件**: $v_{21} = L\frac{di}{dt}$
*   **阻性元件**: $i = \frac{1}{R}v_{21}$

**RLC 无源网络**:

$$
\begin{cases}
L\frac{di(t)}{dt} + Ri(t) + u_o(t) = u_i(t) \\
i(t) = C\frac{du_o(t)}{dt}
\end{cases}
$$

推导可得:

$$
LC\frac{d^2u_o(t)}{dt^2} + RC\frac{du_o(t)}{dt} + u_o(t) = u_i(t)
$$

**机电系统 (示例)**:
输入电压 $u(t)$，输出位移 $x(t)$。

$$
\begin{cases}
Ku(t) = Ri(t) + L\frac{di(t)}{dt} + e \\
e = k_2\frac{dx(t)}{dt} \\
k_2i(t) - c\frac{dx(t)}{dt} - kx(t) = m\frac{d^2x(t)}{dt^2}
\end{cases}
$$

推导可得:

$$
mL\frac{d^3x(t)}{dt^3} + (mR+cL)\frac{d^2x(t)}{dt^2} + (k^2+cR+kL)\frac{dx(t)}{dt} + kR = k_2Ku(t)
$$

**建立微分方程的基本步骤**:
1.  确定系统或各组成元件的输入、输出量。
2.  按照信号传递顺序，列写各环节的微分方程。
3.  简化微分方程，考虑相邻元件间是否存在负载效应。
4.  消去中间变量，得到只含输入、输出量的微分方程。
5.  整理所得方程。输出量在左，输入量在右，各阶导数项按降幂排列，即标准化。

---

## 3.2 系统的传递函数

**微分方程**:

$$
a_n\frac{d^nx_o(t)}{dt^n} + a_{n-1}\frac{d^{n-1}x_o(t)}{dt^{n-1}} + \dots + a_0x_o(t) = b_m\frac{d^mx_i(t)}{dt^m} + b_{m-1}\frac{d^{m-1}x_i(t)}{dt^{m-1}} + \dots + b_0x_i(t)
$$

初始条件为零时，对上式进行拉氏变换:

$$
(a_n s^n + a_{n-1}s^{n-1} + \dots + a_0)X_o(s) = (b_m s^m + b_{m-1}s^{m-1} + \dots + b_0)X_i(s)
$$

**传递函数**:

$$
G(s) = \frac{X_o(s)}{X_i(s)} = \frac{b_m s^m + b_{m-1}s^{m-1} + \dots + b_0}{a_n s^n + a_{n-1}s^{n-1} + \dots + a_0} \quad (n \ge m)
$$

**传递函数的概念**:
对于单输入、单输出线性定常系统，在外界输入作用前，输入、输出的初始条件为零时，输出象函数与输入象函数之比，称为系统的传递函数，用 $G(s)$ 表示。

$$
G(s) = \frac{X_o(s)}{X_i(s)} = \frac{b_m s^m + b_{m-1}s^{m-1} + \dots + b_0}{a_n s^n + a_{n-1}s^{n-1} + \dots + a_0} \quad (n \ge m)
$$

$$
X_o(s) = G(s)X_i(s)
$$

方框图表示:

$X_i(s) \longrightarrow G(s) \longrightarrow X_o(s)$

**传递函数的性质**:
*   $G(s)$ 的分母只取决于系统本身的固有特性，而与外界输入无关；分子只取决于系统与外界之间的关系。
*   对于给定的输入，系统的输出仅取决于传递函数。
    $x_o(t) = L^{-1}[X_o(s)] = L^{-1}[G(s)X_i(s)]$
*   $G(s)$ 为有理分式，要系统有意义，$n \ge m$。（实际系统总是具有惯性的）
*   $G(s)$ 可以有量纲，也可以无量纲。
*   $G(s)$ 与具体的物理系统无关。即相同的传递函数可描述不同的物理系统。
*   传递函数适用于对单输入、单输出的线性定常系统的动态特性进行描述。

**传递函数零点、极点、放大系数**:

$$
G(s) = \frac{X_o(s)}{X_i(s)} = \frac{b_m s^m + b_{m-1}s^{m-1} + \dots + b_0}{a_n s^n + a_{n-1}s^{n-1} + \dots + a_0} \quad (n \ge m)
$$

$G(s)$ 以复变量 $s$ 为自变量，因式分解后， $G(s)$ 可以写成:

$$
G(s) = K \frac{(s - z_1)(s - z_2)\dots(s - z_m)}{(s - p_1)(s - p_2)\dots(s - p_n)} \quad (K \text{ 为常数})
$$

当 $s=z_j (j=1, 2, \dots, m)$ 时， $G(s)=0$，$z_1, z_2, \dots, z_m$ 为 $G(s)$ 的零点。
当 $s=p_i (i=1, 2, \dots, n)$ 时，$G(s) \to \infty$，$p_1, p_2, \dots, p_n$ 为 $G(s)$ 的极点，即微分方程的特征根。

*   **零点**: 影响瞬态响应曲线的形状，不影响系统的稳定性。
*   **极点**: 决定系统瞬态响应的收敛性，即影响系统的稳定性。

当 $s=0$ 时:
$G(0) = K \frac{(-z_1)(-z_2)\dots(-z_m)}{(-p_1)(-p_2)\dots(-p_n)} = \frac{b_0}{a_0}$
$G(0) = K$ (传递系数，胡寿松书；放大系数)

当系统输入为单位阶跃函数 $u(t)$ 时:
$x_o(\infty) = \lim_{s \to 0} sX_o(s) = \lim_{s \to 0} sG(s)X_i(s) = \lim_{s \to 0} G(s) = G(0)$

$G(0)$ — 系统的放大系数，决定系统的稳态输出，由微分方程的常数项决定。

系统的传递函数的零点、极点和放大系数决定着系统的瞬态性能和稳态性能。所以，对系统的研究可变成对系统传递函数零点、极点和放大系数的研究。

### 典型环节的传递函数

1.  **比例环节**:
    *   动力学方程: $x_o(t) = Kx_i(t)$
    *   传递函数: $G(s) = K$
    *   方框图: $X_i(s) \longrightarrow K \longrightarrow X_o(s)$

2.  **惯性环节**:
    *   动力学方程为: $T\frac{dx_o(t)}{dt} + x_o(t) = x_i(t)$
    *   传递函数为: $G(s) = \frac{1}{Ts+1}$
    *   方框图: $X_i(s) \longrightarrow \frac{1}{Ts+1} \longrightarrow X_o(s)$
    *   **示例**:
        *   无源滤波电路: $G(s) = \frac{1}{RCs+1}$
        *   弹簧—阻尼系统: $G(s) = \frac{1}{c/k \cdot s + 1}$

3.  **微分环节**:
    *   动力学方程: $x_o(t) = T\frac{dx_i(t)}{dt}$
    *   传递函数: $G(s) = \frac{X_o(s)}{X_i(s)} = Ts$
    *   方框图: $X_i(s) \longrightarrow Ts \longrightarrow X_o(s)$
    *   **特点**:
        *   一般不能单独存在；
        *   反映输入的变化趋势；使输入提前，预测输入；
        *   增加系统的阻尼；
        *   强化噪声。
    *   **示例**: 微分运算电路 $u_o = -R_1C\dot{u}_i$

4.  **积分环节**:
    *   动力学方程: $x_o(t) = \int x_i(t) dt$
    *   传递函数: $G(s) = \frac{X_o(s)}{X_i(s)} = \frac{1}{s}$
    *   **特点**:
        *   输出累加特性；
        *   输出的滞后作用；
        *   记忆功能。
    *   **示例**: 水箱液位控制。

5.  **振荡环节**:
    *   动力学方程: $T^2\frac{d^2x_o(t)}{dt^2} + 2\xi T\frac{dx_o(t)}{dt} + x_o(t) = x_i(t)$
    *   传递函数: $G(s) = \frac{\omega_n^2}{s^2 + 2\xi\omega_n s + \omega_n^2} \quad (0 \le \xi < 1)$
        *   或 $G(s) = \frac{1}{T^2s^2 + 2Ts + 1}$
    *   其中 $\omega_n$ 为无阻尼固有频率, $\xi$ 为阻尼比, $T = \frac{1}{\omega_n}$ 为时间常数。
    *   **特点**:
        *   $0 \le \xi < 1$ 时, 输出存在振荡, 且 $\xi$ 越小, 振荡越剧烈；
        *   $\xi \ge 1$ 时, 输出无振荡, 非振荡环节是两个一阶惯性环节的组合。

6.  **延时环节**:
    *   $x_o(t) = x_i(t-\tau)$
    *   $G(s) = e^{-\tau s}$
    *   **示例**: 轧钢时带钢厚度检测。

---

## 3.3 系统方框图及其简化

由若干环节按一定关系组成的复杂系统，这些环节用方框来表示，其间用相应的变量及信号流向联系起来，构成系统的方框图。
*   系统内部各环节的数学模型
*   各变量之间的关系
*   信号流向

**方框图的结构要素**: 3个
*   传递函数方框
*   相加点示意图
*   分支点示意图

**系统方框图的建立**:
1.  根据系统工作原理和特性划分若干环节；
2.  建立各个环节的原始微分方程；
3.  对所建立的各个原始微分方程进行拉氏变换，分别建立其传递函数和绘制环节的方框图；
4.  按照信号在系统中传递、变换的关系，依次连接各传递函数方框图，系统输入量置于左端，输出量置于右端，便可得到系统的传递函数方框图。
    方框图中的方框与实际系统的物理元部件并非一一对应。

**方框图的化简 (等效变换)**
等效变换原则是：变换前后前向通道中的传递函数的乘积应保持不变，回路中传递函数的乘积应保持不变。即变换前后整个系统的输入输出传递函数保持不变。

1.  **串联环节**: 前一环节的输出为后一环节输入的联接方式。
    *   环节串联：等效传递函数等于各串联环节的传递函数之积。
    $X_i(s) \xrightarrow{G_1(s)} X_1 \xrightarrow{G_2(s)} X_o(s) \quad \Longleftrightarrow \quad X_i(s) \xrightarrow{G_1(s)G_2(s)} X_o(s)$
2.  **并联环节**: 各环节输入相同，输出为各环节输出的代数和。
    *   环节并联：等效传递函数等于各并联环节的传递函数之和。
    $X_i \rightarrow \begin{cases} \xrightarrow{G_1} X_{o1} \\ \xrightarrow{G_2} X_{o2} \end{cases} \quad \Longleftrightarrow \quad X_i \xrightarrow{G_1 \pm G_2} X_o$
3.  **反馈连接**:
    *   前向通道传递函数: $G(s) = X_o(s) / E(s)$
    *   反馈通道传递函数: $H(s) = B(s) / X_o(s)$
    *   开环传递函数: $G_K(s) = G(s)H(s) = B(s) / E(s)$
    *   闭环传递函数:
        $$
        G_B(s) = \frac{X_o(s)}{X_i(s)} = \frac{G(s)}{1 \pm G(s)H(s)}
        $$
    **注意**:
    *   若相加点的 $B(s)$ 处为负号 $G_B(s) = \frac{G(s)}{1+G(s)H(s)}$
    *   若相加点的 $B(s)$ 处为正号 $G_B(s) = \frac{G(s)}{1-G(s)H(s)}$
    *   闭环系统的反馈是正反馈还是负反馈，与反馈信号在相加点取正号还是负号是两回事。
    *   若反馈回路传递函数 $H(s) = 1$，称为单位反馈。此时的系统称为单位反馈系统。
        $G_B(s) = \frac{G(s)}{1 \pm G(s)}$
    *   闭环传递函数的量纲决定于 $X_o(s)$ 与 $X_i(s)$ 的量纲，两者可以相同也可以不相同。

4.  **分支点的移动规则**:
    *   分支点前移
    *   分支点后移

5.  **相加点的移动规则**:
    *   相加点后移
    *   相加点前移

6.  **相邻相加点的移动规则**
7.  **相邻分支点的移动规则**
    *   **分支点与相加点之间不能相互移动！**

---

## 3.4 考虑扰动作用反馈系统的传递函数

控制系统在实际工作过程中有两类输入信号，给定输入信号 $x_i(t)$，干扰信号 $n(t)$。

**1. 给定输入信号作用下的系统传递函数**:
令系统的干扰信号 $n(t) = 0$。

$$
G_B(s) = \frac{X_{o1}(s)}{X_i(s)} = \frac{G_1(s)G_2(s)}{1+G_1(s)G_2(s)H(s)}
$$

$G_K(s) = G_1(s)G_2(s)H(s)$
系统在给定输入作用下的输出的拉氏变换为:
$X_{o1}(s) = G_B(s)X_i(s) = \frac{G_1(s)G_2(s)}{1+G_1(s)G_2(s)H(s)}X_i(s)$

**2. 干扰信号作用下的系统传递函数**:
令系统的输入信号 $x_i(t) = 0$。

$$
\Phi_B(s) = \frac{X_{o2}(s)}{N(s)} = \frac{G_2(s)}{1+G_1(s)G_2(s)H(s)}
$$

$X_{o2}(s) = \Phi_B(s)N(s) = \frac{G_2(s)}{1+G_1(s)G_2(s)H(s)}N(s)$

**3. 输入信号和干扰信号同时作用下的系统输出**:

$X_o(s) = X_{o1}(s) + X_{o2}(s)$

$$
X_o(s) = \frac{G_1(s)G_2(s)}{1+G_1(s)G_2(s)H(s)}X_i(s) + \frac{G_2(s)}{1+G_1(s)G_2(s)H(s)}N(s)
$$

如果 $|G_1(s)G_2(s)H(s)| \gg 1$ 且 $|G_1(s)H(s)| \gg 1$，则：

$X_{o2}(s) \approx \frac{G_2(s)}{G_1(s)G_2(s)H(s)}N(s) \approx \frac{1}{G_1(s)H(s)}N(s)$

可见，闭环系统能使干扰引起的输出很小。

**3.5 输入和干扰同时作用下的系统传函**
这时，系统的总输出为:

$$
X_o(s) \approx \frac{1}{H(s)}X_i(s) + \frac{1}{G_1(s)H(s)}N(s) \approx \frac{1}{H(s)}X_i(s)
$$

显然，通过反馈回路组成的闭环系统能使总输出 $X_o(s)$ 只随 $X_i(s)$ 而变化，不管外来干扰如何变化，$X_o(s)$ 总是保持不变或变化很小。

**结论**:
通过负反馈回路所组成的闭环控制系统具有较强的抗干扰能力，即干扰信号对输出的影响很小。同时，系统的输出主要取决于反馈回路的传递函数和输入信号，与前向通路的传递函数几乎无关。特别是，当 $H(s) = 1$ 时，即单位负反馈系统，这时系统的输出 $X_o(s) \approx X_i(s)$，从而系统几乎实现了对输入信号的完全复现。

---

## 4. 反馈控制系统中的误差传递函数

**反馈控制系统的典型框图**
$e(t) = x_i(t) - b(t)$
$E(s) = X_i(s) - B(s)$

**(1) 给定输入信号作用下的系统误差传递函数**:
令 $n(t) = 0$。

$$
G_e(s) = \frac{E(s)}{X_i(s)} = \frac{1}{1+G_1(s)G_2(s)H(s)}
$$

**(2) 干扰信号作用下的系统误差传递函数**:
令 $x_i(t) = 0$。

$$
\Phi_e(s) = \frac{E(s)}{N(s)} = \frac{-G_2(s)H(s)}{1+G_1(s)G_2(s)H(s)}
$$

**(3) 输入和干扰信号同时作用下系统误差传函**:
$E(s) = G_e(s)X_i(s) + \Phi_e(s)N(s)$

$$
E(s) = \frac{1}{1+G_1(s)G_2(s)H(s)}X_i(s) + \frac{-G_2(s)H(s)}{1+G_1(s)G_2(s)H(s)}N(s)
$$

如果 $|G_1(s)G_2(s)H(s)| \gg 1$ ，且 $|G_1(s)| \gg 1$，则 $E(s) \approx 0$。
设计控制系统时，只要对组成系统的元器件选择合适的参数，控制系统就可以获得较高的工作精度。