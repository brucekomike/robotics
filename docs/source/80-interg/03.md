# 第三章：基于机器人控制器的系统集成

**2022年10月6日**

---

## 本章学习要点

### 本章学习提要：

机器人控制器是机器人的控制中枢。通过本章学习，您将能够：

*   熟悉工业机器人控制器的结构与组成。
*   掌握工业机器人控制器主要I/O接口信号功能。
*   掌握工业机器人控制器I/O接口信号的电路连接方式。

这将为整个机器人工作站系统的集成化构建奠定基础。

---

## 内容简介

1.  工业机器人通信概述
2.  ABB机器人的标准I/O通信
3.  ABB机器人与西门子PLC通信

---

## 1. 工业机器人通信概述

### 工业机器人典型控制系统硬件工作分工

（此处展示了一个示意图，展示了主计算机、运动控制器、驱动器、伺服电机和传感器之间的交互。）

*   **主计算机**：内含系统板卡，负责系统和数据的存储。它提供与外围设备的连接接口，如网络接口、I/O接口等。
*   **运动控制器**：内含运动学板卡和动力学板卡，负责执行运动学和动力学计算。在集中式控制中，它可能集成在主计算机中。
*   **伺服控制系统**：编码器是内部传感器，外部传感器（如视觉传感器、力传感器）可通过I/O单元与运动控制器通信。
*   **人机交互工具**：如示教器，用于直接操纵执行机构，并进行编程。安全机制可用于在危险情况下立即停止执行机构。

### 典型的控制系统硬件工作流程：

主计算机负责系统的管理和任务处理，并将命令发送给运动控制器。运动控制器控制驱动器、伺服电机和传感器组成的闭环伺服驱动系统，执行机构执行动作，传感器反馈信息给运动控制器。

**总之，硬件设备之间需要通过数据线路按照规定的通信协议标准来进行信息的交互。通信协议规定了硬件接口的标准、通信的模式以及速率，设备之间必须采用相同的通信协议才能正确地进行信息交互。**

### 知识储备：I/O（Input/Output）

I/O是输入/输出的缩写，即输入输出端口，机器人可通过I/O与外部设备进行交互。

*   **数字量输入**：用于接收开关信号（如按钮、接近开关）、传感器信号（如光电传感器）、接触器、继电器触点信号以及触摸屏信号。
*   **数字量输出**：用于控制继电器线圈（如接触器、继电器）、电磁阀以及指示类信号（如指示灯、蜂鸣器）。

### ABB机器人I/O通信的种类

（此处展示了一个树状图，列出了ABB机器人的通信类型，包括总线通信和数据通信，以及各种通信协议如DeviceNet、Profibus、Profinet、EtherNet/IP等。）

### I/O信号类型：

*   **数字量信号 (digital signal)**：离散的信号，只有0和1两种状态，通常用于表示物理触点的断开与闭合。
*   **模拟量信号 (analog signal)**：连续的信号，通常用于表示压力、流量、速度等连续变化的物理量。

---

## 2. ABB机器人的标准I/O通信

### ABB机器人支持的通讯方式与协议

（此处展示了一个表格，列出了ABB机器人支持的通讯功能、协议和连接方式，包括主站功能、从站功能、串口通信和数据通信。）

**ABB工业机器人默认配置是基于DeviceNet通信总线协议的I/O通信板卡，通过此板卡实现主机控制系统与外围工业设备之间的通信。**

### DeviceNet通信：

DeviceNet是一种基于CAN总线的现场总线，采用5线制通信模式。机器人控制柜的Device NET接口属于系统选配功能。

（此处展示了DeviceNet通信硬件配置图和说明表。）

### ABB标准I/O通信板介绍：

*   **DSQC 651**：分布式I/O模块，提供8个数字输入、8个数字输出和2个模拟输出信号的处理。
*   **DSQC 652**：分布式I/O模块，提供16个数字输入和16个数字输出。
*   **DSQC 653**：分布式I/O模块，提供8个数字输入、8个数字输出，并带有继电器。
*   **DSQC 355A**：分布式I/O模块，提供4个模拟输入和4个模拟输出。
*   **DSQC 377A**：输送链跟踪单元。

### DSQC651板的接口说明：

*   **A**：数字输出信号指示灯
*   **B**：X1数字输出接口
*   **C**：X6模拟输出接口
*   **D**：X5是DeviceNet接口
*   **E**：模块状态指示灯
*   **F**：X3数字输入接口
*   **G**：数字输入信号指示灯

### X1-数字输出接口、X3-数字输入接口、X6-模拟输出接口的定义：

（此处展示了三个表格，分别列出了X1、X3和X6接口的子编号、使用定义和地址分配。）

*   **X1-数字输出接口**：提供8个数字输出通道（OUTPUT CH1-CH8），以及0V和24V电源。
*   **X3-数字输入接口**：提供8个数字输入通道（INPUT CH1-CH8），以及0V和未使用选项。
*   **X6-模拟输出接口**：提供2个模拟输出通道（ao1, ao2），以及未使用和0V选项。模拟输出范围为0~+10V。

### X5-DeviceNet接口：

ABB标准I/O板DSQC651挂在DeviceNet网络上，通过端子X5的7~12的跳线来决定模块在网络中的地址，地址范围为10~63。

### 定义DSQC651板的总线连接

（此处展示了一个表格，说明了DSQC651板的总线连接参数，包括Name、Type of Unit、Connected to Bus和DeviceNet Address。）

### DSQC651板的总线连接操作步骤：

1.  在“控制面板”-“配置”画面中，双击“Unit(或Devicenet device)”。
2.  单击“添加”。
3.  按照表格中的参数填写，完成后点击“确定”，重启后完成定义。

### 定义数字输入/输出信号：

1.  在“控制面板”-“配置”画面中，双击“Signal”。
2.  单击“添加”。
3.  根据不同类型的信号，填写参数，完成后点击“确定”，重启后完成设置。

### 数字输入信号di1的相关参数：

*   **Name**：di1
*   **Type of Signal**：Digital Input
*   **Assigned to Unit**：board10
*   **Unit Mapping**：0

### 数字输出信号do1的相关参数：

*   **Name**：do1
*   **Type of Signal**：Digital Output
*   **Assigned to Unit**：board10
*   **Unit Mapping**：32

### 定义组输入/输出信号：

*   **组输入信号gi1**：
    *   **Name**：gi1
    *   **Type of Signal**：Group Input
    *   **Assigned to Unit**：board10
    *   **Unit Mapping**：1~4
*   **组输出信号go1**：
    *   **Name**：go1
    *   **Type of Signal**：Group Output
    *   **Assigned to Unit**：board10
    *   **Unit Mapping**：33~36

**示例：** 组信号占用地址1~4共4位，可以代表十进制数0~15。

### 定义模拟输出信号：

*   **模拟输出信号ao1**：
    *   **Name**：ao1
    *   **Type of Signal**：Analog Output
    *   **Assigned to Unit**：board10
    *   **Unit Mapping**：0~15
    *   **Analog Encoding Type**：Unsigned
    *   **Maximum Logical Value**：10
    *   **Maximum Physical Value**：10

### I/O信号监控和操作：

*   **仿真操作**：用于输入信号，模拟外部设备信号场景。
*   **强制赋值操作**：用于输出信号，直接修改输出值。

（此处展示了ABB菜单中的“输入输出”界面，以及如何进行信号监控、仿真和强制操作的步骤。）

---

## 3. ABB机器人与西门子PLC通信

ABB机器人可以通过DSQC667模块通过Profibus与其它厂商PLC（如西门子PLC）进行通信。

### 通信前提：

*   提供设备的GSD文件。
*   在西门子PLC组态软件中加载GSD文件。
*   进行相关的通信配置。

### 硬件连接：

将西门子300系列PLC通过PROFIBUS-op-v1电缆连接到工业机器人主计算机单元的PROFIBUS接口。

### 获取机器人GSD组态文件：

1.  将U盘插入示教器U盘插孔。
2.  点选资源管理器，找到HMS\_1811.gsd文件。
3.  复制并粘贴到U盘目录，然后导入电脑。
    **注意：** 路径不能包含中文字符，且文件夹名称应为英文。

### 配置PROFIBUS：

1.  打开SIMATIC Manager软件，新建项目。
2.  在左侧导航栏中找到“SIMATI300”，然后双击“硬件”。
3.  在新的配置窗口的菜单栏点击“选项”目录下的“安装GSD文件”。
4.  点击浏览，选择HMS\_1811.gsd文件所在的目录，然后点击确定。
5.  确认加载了HMS\_1811.gsd文件，点击安装。
6.  在出现的通知小窗口点击确定。
7.  右击PLC的CPU型号，选择“替换对象”，选择一款有PROFIBUS-DP通讯功能的CPU（如西门子S7300系列的315-2dp）。
8.  在右侧导航栏中找到“Anybus-cc PROFIBUS-DP-v1”。
9.  拖动“Anybus-cc profibus-dp-v1”到主站图并设置地址。
10. 在PLC中，1 word = 2 bytes，1 byte = 8 bits。添加相应的输入输出模块（如两个2个byte输入模块和一个word输出模块）。
11. 双击添加的模块，设置模块的地址。
12. 使用下载数据线连接到PLC的硬件端口，然后点击“保存编译”与“下载到模块”来保存配置并下载到PLC。

### 机器人端通信配置：

1.  打开示教器控制面板中的“配置”，找到并选择“IndustrialNetwork”。
2.  编辑PROFIBUS地址为“4”（确保与PLC端配置的PROFIBUS地址一致）。
3.  配置I/O，选择“PROFIBUS Internal Anybus Device”，然后编辑“PB\_Internal\_Anybus”。
4.  修改“Input Size”和“Output Size”为2，使机器人端的输入输出信号数量与PLC端一致。

---

**同学们下节课见！**